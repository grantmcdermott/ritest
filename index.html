<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Randomisation Inference Testing • ritest</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Randomisation Inference Testing">
<meta property="og:description" content="An experimental port of the `ritest` Stata routine by Simon Heß.
    Fast and user-friendly. Aims to support a variety of model classes once it 
    is fully baked.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">ritest</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="articles/ritest.html">Get started</a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/grantmcdermott/ritest/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="ritest" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#ritest" class="anchor"></a>ritest</h1></div>
<!-- badges: start -->

<p>Conduct <a href="https://dimewiki.worldbank.org/Randomization_Inference"><strong>randomization inference</strong></a> on R model objects.</p>
<p>This R package is a port of the excellent <a href="https://github.com/simonheb/ritest"><code>-ritest-</code></a> Stata routine by Simon Heß. It doesn’t (yet) try to support all of the features in the Stata version and is currently limited to <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code> and <code><a href="https://lrberge.github.io/fixest/reference/feols.html">fixest::feols()</a></code> models. But it does appear to be significantly faster, and aims to support a variety of model classes once it is fully baked.</p>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># install.packages("remotes")</span>
<span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"grantmcdermott/ritest"</span><span class="op">)</span></code></pre></div>
</div>
<div id="usage" class="section level2">
<h2 class="hasAnchor">
<a href="#usage" class="anchor"></a>Usage</h2>
<p>A detailed walkthrough of the package is provided in the introductory vignette. See <code><a href="articles/ritest.html">vignette("ritest")</a></code>.</p>
<p>As a quickstart, here follows a basic example using data from a randomized control trial (RCT) that was conducted in Colombia. The dataset is provided with this package.</p>
<p>First, we use the <code><a href="https://lrberge.github.io/fixest/reference/feols.html">fixest::feols()</a></code> function to estimate the parametric model.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/grantmcdermott/ritest">ritest</a></span><span class="op">)</span>  <span class="co">## This package</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://lrberge.github.io/fixest/">fixest</a></span><span class="op">)</span>  <span class="co">## For fast (high-dimensional) fixed-effect regressions</span>

<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"colombia"</span><span class="op">)</span>

<span class="co">## Parametric model using fixest::feols()</span>
<span class="va">co_est</span> <span class="op">=</span> 
  <span class="fu"><a href="https://lrberge.github.io/fixest/reference/feols.html">feols</a></span><span class="op">(</span>
    <span class="va">dayscorab</span> <span class="op">~</span> <span class="va">b_treat</span> <span class="op">+</span> <span class="va">b_dayscorab</span> <span class="op">|</span> <span class="va">b_pair</span> <span class="op">+</span> <span class="va">miss_b_dayscorab</span> <span class="op">+</span> <span class="va">round2</span> <span class="op">+</span> <span class="va">round3</span>, 
    vcov <span class="op">=</span> <span class="op">~</span><span class="va">b_block</span>, data <span class="op">=</span> <span class="va">colombia</span>
    <span class="op">)</span>
<span class="va">co_est</span>
<span class="co">#&gt; OLS estimation, Dep. Var.: dayscorab</span>
<span class="co">#&gt; Observations: 2,346 </span>
<span class="co">#&gt; Fixed-effects: b_pair: 31,  miss_b_dayscorab: 2,  round2: 2,  round3: 2</span>
<span class="co">#&gt; Standard-errors: Clustered (b_block) </span>
<span class="co">#&gt;              Estimate Std. Error  t value  Pr(&gt;|t|)    </span>
<span class="co">#&gt; b_treat     -0.180738   0.078174 -2.31201  0.024113 *  </span>
<span class="co">#&gt; b_dayscorab  0.524761   0.029423 17.83478 &lt; 2.2e-16 ***</span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">#&gt; RMSE: 1.91167     Adj. R2: 0.282038</span>
<span class="co">#&gt;                 Within R2: 0.21367</span></code></pre></div>
<p>Our key treatment variable (<code>b_treat</code>) is deemed to be statistically significant (p-value of 0.024), even as we cluster the standard errors.</p>
<p>But let’s see if this result is robust to randomization inference (RI). We’ll perform 1,000 RI permutations on <code>b_treat</code>, whilst taking into account the stratified and clustered experimental design of the underlying RCT.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="reference/ritest.html">ritest</a></span><span class="op">(</span><span class="va">co_est</span>, <span class="st">'b_treat'</span>, strata<span class="op">=</span><span class="st">'b_pair'</span>, cluster<span class="op">=</span><span class="st">'b_block'</span>, reps<span class="op">=</span><span class="fl">1e3</span>, seed<span class="op">=</span><span class="fl">1234</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;           Call: feols(fml = dayscorab ~ b_treat + b_dayscorab + miss_b_dayscorab | b_pair + round2 + round3, data = colombia, vcov = ~b_block)</span>
<span class="co">#&gt;    Res. var(s): b_treat</span>
<span class="co">#&gt;             H0: b_treat=0</span>
<span class="co">#&gt;  Strata var(s): b_pair</span>
<span class="co">#&gt;         Strata: 31</span>
<span class="co">#&gt; Cluster var(s): b_block</span>
<span class="co">#&gt;       Clusters: 63</span>
<span class="co">#&gt;      Num. reps: 1000</span>
<span class="co">#&gt; ──────────────────────────────────────────────────────────────────────────────── </span>
<span class="co">#&gt;   T(obs)         c         n     p=c/n     SE(p)   CI 2.5%  CI 97.5%  </span>
<span class="co">#&gt;  -0.1807       107      1000     0.107   0.01609   0.08054    0.1335  </span>
<span class="co">#&gt; ──────────────────────────────────────────────────────────────────────────────── </span>
<span class="co">#&gt; Note: Confidence interval is with respect to p=c/n. </span>
<span class="co">#&gt; Note: c = #{|T| &gt;= |T(obs)|}</span></code></pre></div>
<p>The simulated p-value is noticeably larger than the parametric one (0.107 vs 0.024), suggesting that our parametric model is overstating the effectiveness of treatment.</p>
<p>For more examples and additional features — plotting, regression tables, etc. — please see the <a href="http://grantmcdermott.com/ritest/articles/ritest.html"><strong>introductory vignette</strong></a>.</p>
</div>
<div id="benchmarks" class="section level2">
<h2 class="hasAnchor">
<a href="#benchmarks" class="anchor"></a>Benchmarks</h2>
<p>I generally observe a speed increase of between 25x–50x compared to the Stata version. Again, see the introductory vignette for timed examples.</p>
</div>
<div id="other-software" class="section level2">
<h2 class="hasAnchor">
<a href="#other-software" class="anchor"></a>Other software</h2>
<p>Apart from the Stata <a href="https://github.com/simonheb/ritest"><code>-ritest-</code></a> routine, there are several other packages for conducting randomization inference in R. For example, the <a href="https://cran.r-project.org/web/packages/ri/index.html"><strong>ri</strong></a> has been available for nearly a decade. More recently, the successor <a href="https://cran.r-project.org/web/packages/ri2/index.html"><strong>ri2</strong></a> package extends upon the original, with updated syntax and functionality. An advantage of <strong>ri2</strong> is that it integrates with the wider <a href="https://declaredesign.org/">DeclareDesign</a> suite of R packages for experimental and empirical research design. This enables researchers to build RI and other experimental considerations into the incipient design process. On the other hand, this places some restrictions on conducting RI <em>ex post</em> or in quasi-experimental settings (e.g. a study that leverages a natural experiment). For example, you can’t pass an existing regression model object to <code>ri2::conduct_ri()</code>, which is what <code><a href="reference/ritest.html">ritest::ritest()</a></code> was designed for. Your use case will likely determine which software is optimal for you.</p>
</div>
<div id="license" class="section level2">
<h2 class="hasAnchor">
<a href="#license" class="anchor"></a>License</h2>
<p>The software code contained within this repository is made available under the <a href="http://opensource.org/licenses/mit-license.php">MIT license</a>.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="https://github.com/grantmcdermott/ritest/">https://​github.com/​grantmcdermott/​ritest/​</a>
</li>
<li>Report a bug at <br><a href="https://github.com/grantmcdermott/ritest/issues">https://​github.com/​grantmcdermott/​ritest/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Grant McDermott <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0001-7883-8573" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li><a href="authors.html">All authors...</a></li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/grantmcdermott/ritest/actions"><img src="https://github.com/grantmcdermott/ritest/workflows/R-CMD-check/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://app.codecov.io/gh/grantmcdermott/ritest?branch=master"><img src="https://codecov.io/gh/grantmcdermott/ritest/branch/master/graph/badge.svg" alt="Codecov test coverage"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Grant McDermott.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
